(function(t){function e(e){for(var s,n,a=e[0],l=e[1],u=e[2],c=0,p=[];c<a.length;c++)n=a[c],o[n]&&p.push(o[n][0]),o[n]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);d&&d(e);while(p.length)p.shift()();return i.push.apply(i,u||[]),r()}function r(){for(var t,e=0;e<i.length;e++){for(var r=i[e],s=!0,n=1;n<r.length;n++){var a=r[n];0!==o[a]&&(s=!1)}s&&(i.splice(e--,1),t=l(l.s=r[0]))}return t}var s={},n={app:0},o={app:0},i=[];function a(t){return l.p+"js/"+({about:"about"}[t]||t)+"."+{about:"fc6a4258"}[t]+".js"}function l(e){if(s[e])return s[e].exports;var r=s[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,l),r.l=!0,r.exports}l.e=function(t){var e=[],r={about:1};n[t]?e.push(n[t]):0!==n[t]&&r[t]&&e.push(n[t]=new Promise(function(e,r){for(var s="css/"+({about:"about"}[t]||t)+"."+{about:"cc31d190"}[t]+".css",o=l.p+s,i=document.getElementsByTagName("link"),a=0;a<i.length;a++){var u=i[a],c=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(c===s||c===o))return e()}var p=document.getElementsByTagName("style");for(a=0;a<p.length;a++){u=p[a],c=u.getAttribute("data-href");if(c===s||c===o)return e()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=e,d.onerror=function(e){var s=e&&e.target&&e.target.src||o,i=new Error("Loading CSS chunk "+t+" failed.\n("+s+")");i.request=s,delete n[t],d.parentNode.removeChild(d),r(i)},d.href=o;var h=document.getElementsByTagName("head")[0];h.appendChild(d)}).then(function(){n[t]=0}));var s=o[t];if(0!==s)if(s)e.push(s[2]);else{var i=new Promise(function(e,r){s=o[t]=[e,r]});e.push(s[2]=i);var u,c=document.createElement("script");c.charset="utf-8",c.timeout=120,l.nc&&c.setAttribute("nonce",l.nc),c.src=a(t),u=function(e){c.onerror=c.onload=null,clearTimeout(p);var r=o[t];if(0!==r){if(r){var s=e&&("load"===e.type?"missing":e.type),n=e&&e.target&&e.target.src,i=new Error("Loading chunk "+t+" failed.\n("+s+": "+n+")");i.type=s,i.request=n,r[1](i)}o[t]=void 0}};var p=setTimeout(function(){u({type:"timeout",target:c})},12e4);c.onerror=c.onload=u,document.head.appendChild(c)}return Promise.all(e)},l.m=t,l.c=s,l.d=function(t,e,r){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(l.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)l.d(r,s,function(e){return t[e]}.bind(null,s));return r},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="/",l.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],c=u.push.bind(u);u.push=e,u=u.slice();for(var p=0;p<u.length;p++)e(u[p]);var d=c;i.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("cd49")},7493:function(t,e,r){},cd49:function(t,e,r){"use strict";r.r(e);var s=r("2b0e"),n=r("ce5b"),o=r.n(n);r("da64");s["default"].use(o.a,{iconfont:"md"});var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-app",[r("v-navigation-drawer",{attrs:{"hide-overlay":"",fixed:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[r("v-list",[r("v-list-tile",{attrs:{to:"/"}},[r("v-list-tile-action",[r("v-icon",[t._v("home")])],1),r("v-list-tile-content",[r("v-list-tile-title",[t._v("\n\t\t\t\t\t\tブログシステム\n\t\t\t\t\t")])],1)],1),r("v-divider"),r("UserForList",{attrs:{user:t.store.user}}),r("v-divider"),t.store.user?r("v-list-tile",{attrs:{to:"/_do_post"}},[r("v-list-tile-action",[r("v-icon",[t._v("create")])],1),r("v-list-tile-content",[r("v-list-tile-title",[t._v("\n\t\t\t\t\t\t記事を書く\n\t\t\t\t\t")])],1)],1):t._e(),r("v-list-tile",{attrs:{to:"/about"}},[r("v-list-tile-action",[r("v-icon",[t._v("info")])],1),r("v-list-tile-content",[r("v-list-tile-title",[t._v("\n\t\t\t\t\t\tこのサイトについて\n\t\t\t\t\t")])],1)],1)],1)],1),r("v-toolbar",{attrs:{app:""}},[r("v-toolbar-side-icon",{on:{click:function(e){t.drawer=!t.drawer}}}),r("v-toolbar-title",[r("router-link",{attrs:{to:"/"}},[t._v("\n\t\t\t\tブログシステム\n\t\t\t")])],1),r("v-spacer"),r("v-toolbar-items",{staticClass:"hidden-sm-and-down"},[t.store.user?r("v-btn",{attrs:{icon:"",to:"/_do_post",title:"記事を書く"}},[r("v-icon",[t._v("create")])],1):t._e(),r("v-btn",{attrs:{icon:"",to:"/about",title:"このサイトについて"}},[r("v-icon",[t._v("info")])],1)],1),r("UserForToolbar",{staticClass:"hidden-sm-and-down",attrs:{user:t.store.user}})],1),r("v-content",[r("v-container",[r("router-view")],1)],1),r("RegisterUser",{attrs:{user:t.store.user}})],1)},a=[],l=r("9ab4"),u=r("60a3"),c=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-card",{attrs:{flat:""}},[t.user?r("v-list",{staticClass:"pa-0"},[r("v-list-tile",{attrs:{avatar:"",to:{name:"user",params:{userName:t.user.name}}}},[r("v-list-tile-avatar",[r("v-icon",[t._v("person")])],1),r("v-list-tile-content",[r("v-list-tile-title",[t._v(t._s(t.user.displayName))])],1)],1)],1):t._e(),r("v-list",{staticClass:"pa-0"},[t.user?r("v-list-tile",{on:{click:t.signOut}},[r("v-list-tile-action"),r("v-list-tile-content",[r("v-list-tile-title",[t._v("\n\t\t\t\t\tSignOut\n\t\t\t\t")])],1)],1):r("v-list-tile",{on:{click:t.signIn}},[r("v-list-tile-action"),r("v-list-tile-content",[r("v-list-tile-title",[t._v("\n\t\t\t\t\tSignIn\n\t\t\t\t")])],1)],1)],1)],1)},p=[],d=r("59ca"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l["c"](e,t),e.prototype.signIn=function(){var t=new d["auth"].GoogleAuthProvider;d["auth"]().signInWithRedirect(t)},e.prototype.signOut=function(){d["auth"]().signOut()},l["b"]([Object(u["b"])()],e.prototype,"user",void 0),e=l["b"]([Object(u["a"])({})],e),e}(u["c"]),f=h,v=f,b=r("2877"),m=r("6544"),y=r.n(m),g=r("b0af"),_=r("132d"),P=r("8860"),w=r("ba95"),j=r("40fe"),x=r("c954"),O=r("5d23"),V=Object(b["a"])(v,c,p,!1,null,null,null),N=V.exports;y()(V,{VCard:g["a"],VIcon:_["a"],VList:P["a"],VListTile:w["a"],VListTileAction:j["a"],VListTileAvatar:x["a"],VListTileContent:O["a"],VListTileTitle:O["c"]});var T=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-toolbar-items",[t.user?r("v-btn",{attrs:{flat:"",to:{name:"user",params:{userName:t.user.name}}}},[t._v("\n\t\t"+t._s(t.user.displayName)+"\n\t")]):t._e(),t.user?r("v-btn",{attrs:{flat:""},on:{click:t.signOut}},[t._v("signOut")]):r("v-btn",{attrs:{flat:""},on:{click:t.signIn}},[t._v("signIn")])],1)},U=[],k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l["c"](e,t),e.prototype.signIn=function(){var t=new d["auth"].GoogleAuthProvider;d["auth"]().signInWithRedirect(t)},e.prototype.signOut=function(){d["auth"]().signOut()},l["b"]([Object(u["b"])()],e.prototype,"user",void 0),e=l["b"]([Object(u["a"])({})],e),e}(u["c"]),C=k,$=C,I=r("8336"),L=r("2a7f"),F=Object(b["a"])($,T,U,!1,null,null,null),E=F.exports;function R(t,e){return{id:t,name:e.name,displayName:e.displayName,created:e.created.toDate(),postCount:e.postCount}}function M(t,e){return null==e?{id:t.uid,displayName:t.displayName||t.email||t.uid,verified:t.emailVerified,registered:!1}:{id:t.uid,verified:t.emailVerified,registered:!0,name:e.name,displayName:e.displayName,created:e.created.toDate()}}function D(t){var e=t.data();return{subject:e.subject,body:e.body,created:e.created,updated:e.updated,id:t.id}}function S(t){return new Promise(function(e,r){d["firestore"]().collection("users").where("id","==",t.uid).get().then(function(r){if(0!==r.docs.length){var s=r.docs[0].data();e(M(t,s))}else e(M(t))}).catch(r)})}y()(F,{VBtn:I["a"],VToolbarItems:L["a"]});var B={user:null,firebaseUser:null,refresh:function(){return l["a"](this,void 0,void 0,function(){var t,e;return l["d"](this,function(r){switch(r.label){case 0:if(null==this.firebaseUser)return this.user=null,console.log("user is null"),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),t=this,[4,S(this.firebaseUser)];case 2:return t.user=r.sent(),console.log("user",this.user),[3,4];case 3:return e=r.sent(),console.error("get user data error",e),[3,4];case 4:return[2]}})})},initialize:function(){var t=this,e=d["auth"]().currentUser;null!=e&&(this.firebaseUser=e,this.refresh()),d["auth"]().onAuthStateChanged(function(e){return l["a"](t,void 0,void 0,function(){return l["d"](this,function(t){return null==e?(this.firebaseUser=null,this.refresh()):(this.firebaseUser=e,this.refresh()),[2]})})},function(t){console.error("error auth: ",t)})}},A=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-layout",{attrs:{row:"","justify-center":""}},[r("v-dialog",{attrs:{persistent:""},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[r("v-card",[r("v-card-title",[t._v("\n\t\t\t\tユーザ登録\n\t\t\t")]),r("v-card-text",[r("v-container",[r("v-form",{on:{submit:function(e){return e.preventDefault(),t.register(e)}}},[r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{placeholder:"識別名",required:"",label:"識別名"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{placeholder:"表示名",required:"",label:"表示名"},model:{value:t.displayName,callback:function(e){t.displayName=e},expression:"displayName"}})],1),r("v-flex",{attrs:{xs12:""}},[r("v-btn",{attrs:{color:"success"},on:{click:t.register}},[t._v("\n\t\t\t\t\t\t\t\t登録\n\t\t\t\t\t\t\t")]),r("v-btn",{attrs:{color:"error"},on:{click:t.cancel}},[t._v("\n\t\t\t\t\t\t\t\tキャンセル\n\t\t\t\t\t\t\t")])],1)],1)],1)],1)],1)],1)],1)},q=[],z=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=null,e.displayName=null,e.dialog=!1,e}return l["c"](e,t),e.prototype.onUserChanged=function(){this.dialog=null!=this.user&&!1===this.user.registered},e.prototype.register=function(){if(null!=this.name&&""!==this.name&&null!=this.displayName&&""!==this.displayName){var t={id:this.user.id,name:this.name,displayName:this.displayName,created:d["firestore"].FieldValue.serverTimestamp(),postCount:0};d["firestore"]().collection("users").doc(t.name).set(t).then(function(t){null==t?(B.refresh(),console.log("registered user")):console.error("register user error",t)}).catch(function(t){console.error("register user error",t)})}},e.prototype.cancel=function(){d["auth"]().signOut()},l["b"]([Object(u["b"])()],e.prototype,"user",void 0),l["b"]([Object(u["d"])("user")],e.prototype,"onUserChanged",null),e=l["b"]([Object(u["a"])({})],e),e}(u["c"]),G=z,H=G,J=r("99d9"),W=r("12b2"),Y=r("a523"),K=r("169a"),Q=r("0e8f"),X=r("4bd4"),Z=r("a722"),tt=r("2677"),et=Object(b["a"])(H,A,q,!1,null,null,null),rt=et.exports;y()(et,{VBtn:I["a"],VCard:g["a"],VCardText:J["a"],VCardTitle:W["a"],VContainer:Y["a"],VDialog:K["a"],VFlex:Q["a"],VForm:X["a"],VLayout:Z["a"],VTextField:tt["a"]});var st=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.store=B,e.drawer=!1,e}return l["c"](e,t),e=l["b"]([Object(u["a"])({components:{UserForList:N,UserForToolbar:E,RegisterUser:rt}})],e),e}(u["c"]),nt=st,ot=nt,it=(r("dc52"),r("7496")),at=r("549c"),lt=r("ce7e"),ut=r("f774"),ct=r("9910"),pt=r("71d9"),dt=r("706c"),ht=Object(b["a"])(ot,i,a,!1,null,"edafe632",null),ft=ht.exports;y()(ht,{VApp:it["a"],VBtn:I["a"],VContainer:Y["a"],VContent:at["a"],VDivider:lt["a"],VIcon:_["a"],VList:P["a"],VListTile:w["a"],VListTileAction:j["a"],VListTileContent:O["a"],VListTileTitle:O["c"],VNavigationDrawer:ut["a"],VSpacer:ct["a"],VToolbar:pt["a"],VToolbarItems:L["a"],VToolbarSideIcon:dt["a"],VToolbarTitle:L["b"]});r("e71f"),r("588e"),r("ea7b");var vt=r("8c4f"),bt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"home"}},[r("v-list",{attrs:{"two-line":""}},[t._l(t.posts,function(t,e){return[r("TopPostTitle",{key:e,attrs:{post:t}})]})],2)],1)},mt=[],yt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-list-tile",{attrs:{to:{name:"userPost",params:{userName:t.post.userName,postId:t.post.postRef.id}}}},[r("v-list-tile-content",[r("v-list-tile-title",[t._v(t._s(t.post.subject))]),r("v-list-tile-sub-title",[t._v("\n\t\t\t"+t._s(t.date)+"\n\t\t\t -\n\t\t\t"),r("router-link",{attrs:{to:{name:"user",params:{userName:t.post.userName}}}},[t._v("\n\t\t\t\t"+t._s(t.post.userDisplayName)+"\n\t\t\t")])],1)],1)],1)},gt=[],_t=r("d4cd"),Pt=r.n(_t),wt=Pt()({html:!0,linkify:!0});function jt(t){return wt.render(t)}function xt(t){var e=t.toDate();return e.getFullYear()+"年"+(e.getMonth()+1)+"月"+e.getDate()+"日 "+e.getHours()+"時"+e.getMinutes()+"分"}function Ot(t){if(!t)return"";var e=t.lastIndexOf(".");return-1===e?"":t.substr(e+1)}var Vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l["c"](e,t),Object.defineProperty(e.prototype,"date",{get:function(){return xt(this.post.created)},enumerable:!0,configurable:!0}),l["b"]([Object(u["b"])()],e.prototype,"post",void 0),e=l["b"]([Object(u["a"])({})],e),e}(u["c"]),Nt=Vt,Tt=Nt,Ut=Object(b["a"])(Tt,yt,gt,!1,null,null,null),kt=Ut.exports;y()(Ut,{VListTile:w["a"],VListTileContent:O["a"],VListTileSubTitle:O["b"],VListTileTitle:O["c"]});var Ct=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.postRef=null,e.posts=[],e}return l["c"](e,t),e.prototype.created=function(){return l["a"](this,void 0,void 0,function(){var t,e,r=this;return l["d"](this,function(s){switch(s.label){case 0:this.postRef=d["firestore"]().collection("allPosts"),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.postRef.orderBy("created","desc").limit(100).get()];case 2:return t=s.sent(),this.posts=[],t.forEach(function(t){var e=t.data();r.posts.push({subject:e.subject,body:e.body,created:e.created,updated:e.updated,postRef:e.postRef,userId:e.userId,userName:e.userName,userDisplayName:e.userDisplayName})}),[3,4];case 3:return e=s.sent(),console.error("get data error",e),[3,4];case 4:return[2]}})})},e=l["b"]([Object(u["a"])({components:{TopPostTitle:kt}})],e),e}(u["c"]),$t=Ct,It=$t,Lt=Object(b["a"])(It,bt,mt,!1,null,null,null),Ft=Lt.exports;y()(Lt,{VList:P["a"]});var Et=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-form",{ref:"postForm",attrs:{id:"postForm","lazy-validation":""},on:{submit:function(e){return e.preventDefault(),t.post(e)}}},[r("div",{directives:[{name:"show",rawName:"v-show",value:t.msg,expression:"msg"}]},[t._v(t._s(t.msg))]),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs12:"",md12:""}},[r("v-text-field",{attrs:{placeholder:"タイトル","aria-label":"ブログの記事タイトル",required:"",label:"タイトル",rules:t.titleRule},model:{value:t.subject,callback:function(e){t.subject=e},expression:"subject"}})],1),r("v-flex",{attrs:{xs12:"",md12:""}},[r("v-layout",[r("v-flex",{attrs:{xs12:"",sm3:"",md3:""}},[r("v-btn",{attrs:{color:"success"},on:{click:function(e){return t.$refs.inputUpload.click()}}},[t._v("画像を追加")]),r("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"inputUpload",attrs:{type:"file",multiple:"false"},on:{change:t.uploadFile}})],1),r("v-flex",{attrs:{xs12:"",sm9:"",md9:""}},[r("v-text-field",{ref:"url",attrs:{label:"画像のURL",placeholder:"アップロードされた画像のURLが入ります",readonly:!0},on:{click:t.copyUrl},model:{value:t.imageUrl,callback:function(e){t.imageUrl=e},expression:"imageUrl"}})],1)],1)],1),r("v-flex",{attrs:{xs12:"",sm12:"",md6:""}},[r("v-textarea",{ref:"body",attrs:{placeholder:"本文","aria-label":"ブログの本文",required:"","auto-grow":"",label:"本文",rules:t.bodyRule,rows:"16"},model:{value:t.body,callback:function(e){t.body=e},expression:"body"}})],1),r("v-flex",{attrs:{xs12:"",sm12:"",md6:""}},[r("MarkdownView",{attrs:{body:t.body}})],1)],1),r("v-btn",{attrs:{color:"success",type:"submit"}},[t._v("投稿")])],1)},Rt=[],Mt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t.raw?r("v-textarea",{ref:"textarea",attrs:{readonly:"",row:"16"},on:{click:t.copy}},[t._v("\n\t\t"+t._s(t.preview)+"\n\t")]):r("div",{domProps:{innerHTML:t._s(t.preview)}})],1)},Dt=[],St=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l["c"](e,t),e.prototype.copy=function(){var t=this.$refs.textarea.$refs.input;t.select(),document.execCommand("copy")},Object.defineProperty(e.prototype,"preview",{get:function(){return this.raw?this.body:jt(this.body)},enumerable:!0,configurable:!0}),l["b"]([Object(u["b"])()],e.prototype,"body",void 0),l["b"]([Object(u["b"])({type:Boolean,default:!1})],e.prototype,"raw",void 0),e=l["b"]([Object(u["a"])({})],e),e}(u["c"]),Bt=St,At=Bt,qt=r("a844"),zt=Object(b["a"])(At,Mt,Dt,!1,null,null,null),Gt=zt.exports;y()(zt,{VTextarea:qt["a"]});var Ht=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.subject="",e.body="",e.msg="",e.imageUrl="",e}return l["c"](e,t),Object.defineProperty(e.prototype,"titleRule",{get:function(){return[function(t){return 0!==t.length||"タイトルを入力してください"}]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bodyRule",{get:function(){return[function(t){return 0!==t.length||"本文を入力してください"}]},enumerable:!0,configurable:!0}),e.prototype.copyUrl=function(){var t=this.$refs.url.$refs.input;t.select(),document.execCommand("copy")},e.prototype.uploadFile=function(){return l["a"](this,void 0,void 0,function(){var t,e,r,s,n,o,i,a,u;return l["d"](this,function(l){switch(l.label){case 0:if(t=this.$refs.inputUpload,null==t.files||0===t.files.length)return alert("選択してください"),[2];e=d["storage"]().ref("user/"+this.owner.id+"/public"),l.label=1;case 1:return l.trys.push([1,6,,7]),r=t.files[0],s={contentType:r.type},n=Ot(r.name),n?(o=Date.now().toString(16)+"."+n,[4,e.child(o).put(r,s)]):(alert("拡張子付きのファイルをアップロードしてください"),[2]);case 2:return i=l.sent(),"success"!==i.state?[3,5]:null!=i.downloadURL?[3,4]:[4,i.ref.getDownloadURL()];case 3:return a=l.sent(),console.log("getDownloadURL",a),this.imageUrl=a,[3,5];case 4:this.imageUrl=i.downloadURL,l.label=5;case 5:return[3,7];case 6:return u=l.sent(),console.error("upload file error",u),[3,7];case 7:return[2]}})})},e.prototype.post=function(){return l["a"](this,void 0,void 0,function(){var t,e;return l["d"](this,function(r){switch(r.label){case 0:if(!this.$refs.postForm.validate())return[2];if(null==this.owner||!this.owner.registered)return this.msg="ログインしてください。",[2];t={subject:this.subject,body:this.body,created:d["firestore"].FieldValue.serverTimestamp(),updated:d["firestore"].FieldValue.serverTimestamp()},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,d["firestore"]().collection("users").doc(this.owner.name).collection("posts").add(t)];case 2:return r.sent(),this.$_postForm_clear(),this.msg="投稿しました。",[3,4];case 3:return e=r.sent(),console.error("add error",e),this.msg="投稿失敗",[3,4];case 4:return[2]}})})},e.prototype.$_postForm_clear=function(){this.subject="",this.body="",this.$refs.postForm.resetValidation()},l["b"]([Object(u["b"])()],e.prototype,"owner",void 0),e=l["b"]([Object(u["a"])({components:{MarkdownView:Gt}})],e),e}(u["c"]),Jt=Ht,Wt=Jt,Yt=Object(b["a"])(Wt,Et,Rt,!1,null,null,null),Kt=Yt.exports;y()(Yt,{VBtn:I["a"],VFlex:Q["a"],VForm:X["a"],VLayout:Z["a"],VTextField:tt["a"],VTextarea:qt["a"]});var Qt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"user"}},[t.user?r("h1",[t._v(t._s(t.user.displayName)+"の投稿")]):t._e(),[r("div",{staticClass:"prev_pager"},[t.hasPrev?[r("v-btn",{attrs:{color:"info"},on:{click:t.prev}},[t._v("新しい記事")])]:t._e()],2),t._l(t.posts,function(e,s){return r("PostView",{key:s,staticClass:"mb-4",attrs:{post:e,user:t.user}})}),r("div",{staticClass:"next_pager"},[t.hasNext?[r("v-btn",{attrs:{color:"info"},on:{click:t.next}},[t._v("前の記事")])]:t._e()],2)]],2)},Xt=[],Zt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-card",[r("v-card-title",[r("h1",[r("router-link",{attrs:{to:{name:"userPost",params:{userName:t.user.name,postId:t.post.id}}}},[t._v("\n\t\t\t\t"+t._s(t.post.subject)+"\n\t\t\t")])],1)]),r("v-divider"),r("v-card-text",[r("MarkdownView",{attrs:{body:t.post.body}})],1),r("v-divider"),r("v-card-text",[r("router-link",{attrs:{to:{name:"user",params:{userName:t.user.name}}}},[t._v("\n\t\t\t"+t._s(t.user.displayName)+"\n\t\t")]),r("span",[t._v(" - "+t._s(t.date))])],1)],1)},te=[],ee=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l["c"](e,t),Object.defineProperty(e.prototype,"date",{get:function(){return xt(this.post.created)},enumerable:!0,configurable:!0}),l["b"]([Object(u["b"])()],e.prototype,"user",void 0),l["b"]([Object(u["b"])()],e.prototype,"post",void 0),e=l["b"]([Object(u["a"])({components:{MarkdownView:Gt}})],e),e}(u["c"]),re=ee,se=re,ne=Object(b["a"])(se,Zt,te,!1,null,null,null),oe=ne.exports;y()(ne,{VCard:g["a"],VCardText:J["a"],VCardTitle:W["a"],VDivider:lt["a"]});var ie=d["firestore"],ae=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.posts=[],e.lastPost=null,e.firstPost=null,e.hasPrev=!1,e.hasNext=!1,e.user=null,e.sinceId=null,e}return l["c"](e,t),Object.defineProperty(e.prototype,"prevLink",{get:function(){return null==this.firstPost?"?":"?since="+this.firstPost.id+"&order=asc"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextLink",{get:function(){return null==this.lastPost?"?":"?since="+this.lastPost.id},enumerable:!0,configurable:!0}),e.prototype.next=function(){return l["a"](this,void 0,void 0,function(){var t,e;return l["d"](this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.$_UserPosts_getPosts(this.lastPost)];case 1:return t=r.sent(),this.posts=this.posts.concat(t),this.$_UserPosts_refreshLastFirst(t),[3,3];case 2:return e=r.sent(),[2,Promise.reject(e)];case 3:return[2]}})})},e.prototype.prev=function(){return l["a"](this,void 0,void 0,function(){var t,e,r=this;return l["d"](this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.$_UserPosts_getPosts(this.firstPost,"asc")];case 1:return t=s.sent(),t.forEach(function(t){r.posts.unshift(t)}),this.$_UserPosts_refreshLastFirst(t,"asc"),[3,3];case 2:return e=s.sent(),[2,Promise.reject(e)];case 3:return[2]}})})},e.prototype.created=function(){return l["a"](this,void 0,void 0,function(){var t,e,r,s;return l["d"](this,function(n){switch(n.label){case 0:t=ie().collection("users").doc(this.userName),n.label=1;case 1:return n.trys.push([1,4,,5]),this.sinceId=this.since,[4,t.get()];case 2:return e=n.sent(),r=this,[4,this.$_UserPosts_getPostsByProps()];case 3:return r.posts=n.sent(),"asc"===this.order&&this.posts.reverse(),this.user=R(this.userName,e.data()),this.$_UserPosts_refreshLastFirst(this.posts,this.order),[3,5];case 4:return s=n.sent(),console.error("get data error",s),[3,5];case 5:return[2]}})})},e.prototype.$_UserPosts_getPosts=function(t,e){return void 0===t&&(t=null),void 0===e&&(e="desc"),l["a"](this,void 0,void 0,function(){var r,s,n,o,i;return l["d"](this,function(a){switch(a.label){case 0:a.trys.push([0,5,,6]),r=ie().collection("users").doc(this.userName).collection("posts"),s=r.limit(this.pagingCount).orderBy("created",e),null!=t&&(s=s.startAfter(t.created)),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,s.get()];case 2:return n=a.sent(),[2,this.$_UserPosts_createPosts(n,e)];case 3:return o=a.sent(),[2,Promise.reject(o)];case 4:return[3,6];case 5:return i=a.sent(),[2,Promise.reject(i)];case 6:return[2]}})})},e.prototype.$_UserPosts_createPosts=function(t,e){void 0===e&&(e="desc");var r=[];return t.forEach(function(t){r.push(D(t))}),r},e.prototype.$_UserPosts_getPostsByProps=function(){return l["a"](this,void 0,void 0,function(){var t;return l["d"](this,function(e){switch(e.label){case 0:return null==this.since?[3,3]:[4,this.$_UserPosts_getPost(this.since)];case 1:return t=e.sent(),[4,this.$_UserPosts_getPosts(t,this.order)];case 2:return[2,e.sent()];case 3:return[2,this.$_UserPosts_getPosts()]}})})},e.prototype.$_UserPosts_refreshLastFirst=function(t,e){void 0===e&&(e="desc"),this.posts.length>0?(this.posts.length>this.showCount&&("desc"===e?(this.posts=this.posts.slice(this.posts.length-this.showCount),this.sinceId=this.posts[0].id):(this.posts=this.posts.slice(0,this.showCount-this.posts.length),this.sinceId=this.posts[this.posts.length-1].id)),this.lastPost=this.posts[this.posts.length-1],this.firstPost=this.posts[0]):(this.lastPost=null,this.firstPost=null),"desc"===e?(this.hasNext=t.length>=this.pagingCount,this.hasPrev=null!=this.sinceId):(this.hasPrev=t.length>=this.pagingCount,this.hasNext=null!=this.sinceId)},e.prototype.$_UserPosts_getPost=function(t){return l["a"](this,void 0,Promise,function(){var e,r,s;return l["d"](this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),e=ie().collection("users").doc(this.userName).collection("posts").doc(t),[4,e.get()];case 1:return r=n.sent(),r.exists?[2,D(r)]:[2,null];case 2:return s=n.sent(),[2,Promise.reject(s)];case 3:return[2]}})})},l["b"]([Object(u["b"])()],e.prototype,"userName",void 0),l["b"]([Object(u["b"])({required:!1,default:null})],e.prototype,"since",void 0),l["b"]([Object(u["b"])({required:!0,default:"desc"})],e.prototype,"order",void 0),l["b"]([Object(u["b"])({type:Number,default:5})],e.prototype,"pagingCount",void 0),l["b"]([Object(u["b"])({type:Number,default:10})],e.prototype,"showCount",void 0),e=l["b"]([Object(u["a"])({components:{PostView:oe}})],e),e}(u["c"]),le=ae,ue=le,ce=Object(b["a"])(ue,Qt,Xt,!1,null,null,null),pe=ce.exports;y()(ce,{VBtn:I["a"]});var de=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"home"}},[t.post?r("PostView",{attrs:{user:t.user,post:t.post}}):t._e(),r("RelativePost",{attrs:{post:t.post,userName:t.userName}})],1)},he=[],fe=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t.relativePosts.length>0?r("h3",[t._v("他の記事")]):t._e(),r("ul",t._l(t.relativePosts,function(e,s){return r("li",{key:s},[r("PostLink",{attrs:{userName:t.userName,post:e}})],1)}),0)])},ve=[],be=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("span",[r("router-link",{attrs:{to:{name:"userPost",params:{userName:t.userName,postId:t.post.id}}}},[t._v("\n\t\t"+t._s(t.post.subject)+"\n\t")]),t._v("\n\t ("+t._s(t.date)+")\n")],1)},me=[],ye=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l["c"](e,t),Object.defineProperty(e.prototype,"date",{get:function(){return xt(this.post.created)},enumerable:!0,configurable:!0}),l["b"]([Object(u["b"])()],e.prototype,"userName",void 0),l["b"]([Object(u["b"])()],e.prototype,"post",void 0),e=l["b"]([Object(u["a"])({})],e),e}(u["c"]),ge=ye,_e=ge,Pe=Object(b["a"])(_e,be,me,!1,null,null,null),we=Pe.exports,je=d["firestore"],xe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.relativePosts=[],e}return l["c"](e,t),e.prototype.$_RelativePost_onPostChanged=function(){return l["a"](this,void 0,void 0,function(){var t,e,r,s,n=this;return l["d"](this,function(o){switch(o.label){case 0:this.relativePosts=[],t=je().collection("users").doc(this.userName).collection("posts"),o.label=1;case 1:return o.trys.push([1,3,,4]),e=je.Timestamp.fromMillis(this.post.created.toMillis()-2592e6),[4,t.where("created",">",e).limit(10).get()];case 2:r=o.sent(),r.forEach(function(t){t.id!==n.post.id&&n.relativePosts.push(D(t))});while(this.relativePosts.length>3)this.relativePosts.splice(Math.floor(Math.random()*this.relativePosts.length),1);return[3,4];case 3:return s=o.sent(),console.error("get relative post error",s),[3,4];case 4:return[2]}})})},l["b"]([Object(u["b"])()],e.prototype,"userName",void 0),l["b"]([Object(u["b"])()],e.prototype,"post",void 0),l["b"]([Object(u["d"])("post")],e.prototype,"$_RelativePost_onPostChanged",null),e=l["b"]([Object(u["a"])({components:{PostLink:we}})],e),e}(u["c"]),Oe=xe,Ve=Oe,Ne=Object(b["a"])(Ve,fe,ve,!1,null,null,null),Te=Ne.exports,Ue=d["firestore"],ke=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.post=null,e.relativePosts=[],e.user=null,e}return l["c"](e,t),e.prototype.created=function(){return l["a"](this,void 0,void 0,function(){var t,e;return l["d"](this,function(r){switch(r.label){case 0:return t=Ue().collection("users").doc(this.userName),[4,t.get()];case 1:return e=r.sent(),this.user=R(this.userName,e.data()),[2,this.$_UserPost_onPostIdChanged()]}})})},e.prototype.$_UserPost_onPostIdChanged=function(){return l["a"](this,void 0,void 0,function(){var t,e,r,s,n,o,i=this;return l["d"](this,function(a){switch(a.label){case 0:t=Ue().collection("users").doc(this.userName),this.relativePosts=[],a.label=1;case 1:return a.trys.push([1,4,,5]),e=t.collection("posts"),[4,e.doc(this.postId).get()];case 2:return r=a.sent(),this.post=D(r),s=Ue.Timestamp.fromMillis(this.post.created.toMillis()-2592e6),[4,e.where("created",">",s).limit(10).get()];case 3:n=a.sent(),n.forEach(function(t){t.id!==i.postId&&i.relativePosts.push(D(t))});while(this.relativePosts.length>3)this.relativePosts.splice(Math.floor(Math.random()*this.relativePosts.length),1);return[3,5];case 4:return o=a.sent(),console.error("get data error",o),[3,5];case 5:return[2]}})})},l["b"]([Object(u["b"])()],e.prototype,"userName",void 0),l["b"]([Object(u["b"])()],e.prototype,"postId",void 0),l["b"]([Object(u["d"])("postId")],e.prototype,"$_UserPost_onPostIdChanged",null),e=l["b"]([Object(u["a"])({components:{PostView:oe,RelativePost:Te}})],e),e}(u["c"]),Ce=ke,$e=Ce,Ie=Object(b["a"])($e,de,he,!1,null,null,null),Le=Ie.exports;function Fe(t,e){return void 0===e&&(e=null),null==t?e:"string"===typeof t?parseInt(t,10):parseInt(t[0],10)}function Ee(t){return"asc"===t?"asc":"desc"}s["default"].use(vt["a"]);var Re=new vt["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:Ft},{path:"/about",name:"about",component:function(){return r.e("about").then(r.bind(null,"f3be"))}},{path:"/_do_post",name:"post",component:Kt,props:function(t){return{owner:B.user}}},{path:"/:userName",name:"user",component:pe,props:function(t){return{userName:t.params.userName,since:t.query.since,order:Ee(t.query.order),page:Fe(t.query.page,0)}}},{path:"/:userName/:postId",name:"userPost",component:Le,props:!0}]});s["default"].config.productionTip=!1;var Me={apiKey:"AIzaSyBjpgvDitkbscY8sGri0mHxoiInhhFrLt8",authDomain:"shinonomekazan-blog.firebaseapp.com",databaseURL:"https://shinonomekazan-blog.firebaseio.com",projectId:"shinonomekazan-blog",storageBucket:"gs://shinonomekazan-blog.appspot.com/",messagingSenderId:"1017881661292"};d["initializeApp"](Me),B.initialize(),new s["default"]({router:Re,render:function(t){return t(ft)}}).$mount("#app")},dc52:function(t,e,r){"use strict";var s=r("7493"),n=r.n(s);n.a}});
//# sourceMappingURL=app.008dc687.js.map