(function(t){function e(e){for(var r,i,a=e[0],l=e[1],u=e[2],c=0,d=[];c<a.length;c++)i=a[c],n[i]&&d.push(n[i][0]),n[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r]);p&&p(e);while(d.length)d.shift()();return o.push.apply(o,u||[]),s()}function s(){for(var t,e=0;e<o.length;e++){for(var s=o[e],r=!0,i=1;i<s.length;i++){var l=s[i];0!==n[l]&&(r=!1)}r&&(o.splice(e--,1),t=a(a.s=s[0]))}return t}var r={},n={app:0},o=[];function i(t){return a.p+"js/"+({about:"about"}[t]||t)+"."+{about:"ca53e8e6"}[t]+".js"}function a(e){if(r[e])return r[e].exports;var s=r[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.e=function(t){var e=[],s=n[t];if(0!==s)if(s)e.push(s[2]);else{var r=new Promise(function(e,r){s=n[t]=[e,r]});e.push(s[2]=r);var o,l=document.createElement("script");l.charset="utf-8",l.timeout=120,a.nc&&l.setAttribute("nonce",a.nc),l.src=i(t),o=function(e){l.onerror=l.onload=null,clearTimeout(u);var s=n[t];if(0!==s){if(s){var r=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src,i=new Error("Loading chunk "+t+" failed.\n("+r+": "+o+")");i.type=r,i.request=o,s[1](i)}n[t]=void 0}};var u=setTimeout(function(){o({type:"timeout",target:l})},12e4);l.onerror=l.onload=o,document.head.appendChild(l)}return Promise.all(e)},a.m=t,a.c=r,a.d=function(t,e,s){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(s,r,function(e){return t[e]}.bind(null,r));return s},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/",a.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var p=u;o.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("cd49")},"037a":function(t,e,s){"use strict";var r=s("c22f"),n=s.n(r);n.a},c22f:function(t,e,s){},cd49:function(t,e,s){"use strict";s.r(e);var r=s("2b0e"),n=s("ce5b"),o=s.n(n);s("da64");r["default"].use(o.a,{iconfont:"md"});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-app",[s("RegisterUser",{attrs:{user:t.store.user}}),s("v-navigation-drawer",{attrs:{"hide-overlay":"",fixed:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[s("v-list",[s("v-list-tile",{attrs:{to:"/"}},[s("v-list-tile-action",[s("v-icon",[t._v("home")])],1),s("v-list-tile-content",[s("v-list-tile-title",[t._v("\n\t\t\t\t\t\tブログシステム\n\t\t\t\t\t")])],1)],1),s("v-divider"),s("UserForList",{attrs:{user:t.store.user}}),s("v-divider"),t.store.user?s("v-list-tile",{attrs:{to:"/_do_post"}},[s("v-list-tile-action",[s("v-icon",[t._v("create")])],1),s("v-list-tile-content",[s("v-list-tile-title",[t._v("\n\t\t\t\t\t\t記事を書く\n\t\t\t\t\t")])],1)],1):t._e(),s("v-list-tile",{attrs:{to:"/about"}},[s("v-list-tile-action",[s("v-icon",[t._v("info")])],1),s("v-list-tile-content",[s("v-list-tile-title",[t._v("\n\t\t\t\t\t\tこのサイトについて\n\t\t\t\t\t")])],1)],1)],1)],1),s("v-toolbar",{attrs:{app:""}},[s("v-toolbar-side-icon",{on:{click:function(e){t.drawer=!t.drawer}}}),s("v-toolbar-title",[s("router-link",{attrs:{to:"/"}},[t._v("\n\t\t\t\tブログシステム\n\t\t\t")])],1),s("v-spacer"),s("v-toolbar-items",{staticClass:"hidden-sm-and-down"},[t.store.user?s("v-btn",{attrs:{icon:"",to:"/_do_post",title:"記事を書く"}},[s("v-icon",[t._v("create")])],1):t._e(),s("v-btn",{attrs:{icon:"",to:"/about",title:"このサイトについて"}},[s("v-icon",[t._v("info")])],1)],1),s("UserForToolbar",{staticClass:"hidden-sm-and-down",attrs:{user:t.store.user}})],1),s("v-content",[s("v-container",[s("router-view")],1)],1)],1)},a=[],l=s("9ab4"),u=s("60a3"),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-card",{attrs:{flat:""}},[t.user?s("v-list",{staticClass:"pa-0"},[s("v-list-tile",{attrs:{avatar:"",to:{name:"user",params:{userName:t.user.name}}}},[s("v-list-tile-avatar",[s("v-icon",[t._v("person")])],1),s("v-list-tile-content",[s("v-list-tile-title",[t._v(t._s(t.user.displayName))])],1)],1)],1):t._e(),s("v-list",{staticClass:"pa-0"},[t.user?s("v-list-tile",{on:{click:t.signOut}},[s("v-list-tile-action"),s("v-list-tile-content",[s("v-list-tile-title",[t._v("\n\t\t\t\t\tSignOut\n\t\t\t\t")])],1)],1):s("v-list-tile",{on:{click:t.signIn}},[s("v-list-tile-action"),s("v-list-tile-content",[s("v-list-tile-title",[t._v("\n\t\t\t\t\tSignIn\n\t\t\t\t")])],1)],1)],1)],1)},p=[],d=s("8aa5"),h=s.n(d),v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l["c"](e,t),e.prototype.signIn=function(){var t=new h.a.auth.GoogleAuthProvider;h.a.auth().signInWithRedirect(t)},e.prototype.signOut=function(){h.a.auth().signOut()},l["b"]([Object(u["b"])()],e.prototype,"user",void 0),e=l["b"]([Object(u["a"])({})],e),e}(u["c"]),f=v,b=f,m=s("2877"),y=s("6544"),g=s.n(y),_=s("b0af"),P=s("132d"),j=s("8860"),w=s("ba95"),O=s("40fe"),V=s("c954"),x=s("5d23"),N=Object(m["a"])(b,c,p,!1,null,null,null),T=N.exports;g()(N,{VCard:_["a"],VIcon:P["a"],VList:j["a"],VListTile:w["a"],VListTileAction:O["a"],VListTileAvatar:V["a"],VListTileContent:x["a"],VListTileTitle:x["c"]});var k=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-toolbar-items",[t.user?s("v-btn",{attrs:{flat:"",to:{name:"user",params:{userName:t.user.name}}}},[t._v("\n\t\t"+t._s(t.user.displayName)+"\n\t")]):t._e(),t.user?s("v-btn",{attrs:{flat:""},on:{click:t.signOut}},[t._v("signOut")]):s("v-btn",{attrs:{flat:""},on:{click:t.signIn}},[t._v("signIn")])],1)},C=[],I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l["c"](e,t),e.prototype.signIn=function(){var t=new h.a.auth.GoogleAuthProvider;h.a.auth().signInWithRedirect(t)},e.prototype.signOut=function(){h.a.auth().signOut()},l["b"]([Object(u["b"])()],e.prototype,"user",void 0),e=l["b"]([Object(u["a"])({})],e),e}(u["c"]),$=I,U=$,L=s("8336"),F=s("2a7f"),E=Object(m["a"])(U,k,C,!1,null,null,null),M=E.exports;function R(t,e){return{id:t,name:e.name,displayName:e.displayName,created:e.created.toDate(),postCount:e.postCount}}function D(t,e){return null==e?{id:t.uid,displayName:t.displayName||t.email||t.uid,verified:t.emailVerified,registered:!1}:{id:t.uid,verified:t.emailVerified,registered:!0,name:e.name,displayName:e.displayName,created:e.created.toDate()}}function S(t){var e=t.data();return{subject:e.subject,body:e.body,created:e.created,updated:e.updated,id:t.id}}function A(t){return new Promise(function(e,s){h.a.firestore().collection("users").where("id","==",t.uid).get().then(function(s){if(0!==s.docs.length){var r=s.docs[0].data();console.log(r),e(D(t,r))}else e(D(t))}).catch(s)})}g()(E,{VBtn:L["a"],VToolbarItems:F["a"]});var B={user:null,firebaseUser:null,refresh:function(){return l["a"](this,void 0,void 0,function(){var t,e;return l["d"](this,function(s){switch(s.label){case 0:if(null==this.firebaseUser)return this.user=null,console.log("user is null"),[2];s.label=1;case 1:return s.trys.push([1,3,,4]),t=this,[4,A(this.firebaseUser)];case 2:return t.user=s.sent(),console.log("user",this.user),[3,4];case 3:return e=s.sent(),console.error("get user data error",e),[3,4];case 4:return[2]}})})},initialize:function(){var t=this,e=h.a.auth().currentUser;null!=e&&(this.firebaseUser=e,this.refresh()),h.a.auth().onAuthStateChanged(function(e){return l["a"](t,void 0,void 0,function(){return l["d"](this,function(t){return null==e?(this.firebaseUser=null,this.refresh()):(this.firebaseUser=e,this.refresh()),[2]})})},function(t){console.error("error auth: ",t)})}},q=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-layout",{attrs:{row:"","justify-center":""}},[s("v-dialog",{attrs:{persistent:""},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("v-card",[s("v-card-title",[t._v("\n\t\t\t\tユーザ登録\n\t\t\t")]),s("v-card-text",[s("v-container",[s("v-form",{on:{submit:function(e){return e.preventDefault(),t.register(e)}}},[s("v-flex",{attrs:{xs12:""}},[s("v-text-field",{attrs:{placeholder:"識別名",required:"",label:"識別名"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),s("v-flex",{attrs:{xs12:""}},[s("v-text-field",{attrs:{placeholder:"表示名",required:"",label:"表示名"},model:{value:t.displayName,callback:function(e){t.displayName=e},expression:"displayName"}})],1),s("v-flex",{attrs:{xs12:""}},[s("v-btn",{attrs:{color:"success"},on:{click:t.register}},[t._v("\n\t\t\t\t\t\t\t\t登録\n\t\t\t\t\t\t\t")]),s("v-btn",{attrs:{color:"error"},on:{click:t.cancel}},[t._v("\n\t\t\t\t\t\t\t\tキャンセル\n\t\t\t\t\t\t\t")])],1)],1)],1)],1)],1)],1)],1)},z=[],G=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=null,e.displayName=null,e.dialog=!1,e}return l["c"](e,t),e.prototype.onUserChanged=function(){this.dialog=null!=this.user&&!1===this.user.registered},e.prototype.register=function(){if(null!=this.name&&""!==this.name&&null!=this.displayName&&""!==this.displayName){var t={id:this.user.id,name:this.name,displayName:this.displayName,created:h.a.firestore.FieldValue.serverTimestamp(),postCount:0};h.a.firestore().collection("users").doc(t.name).set(t).then(function(t){null==t?(B.refresh(),console.log("registered user")):console.error("register user error",t)}).catch(function(t){console.error("register user error",t)})}},e.prototype.cancel=function(){h.a.auth().signOut()},l["b"]([Object(u["b"])()],e.prototype,"user",void 0),l["b"]([Object(u["d"])("user")],e.prototype,"onUserChanged",null),e=l["b"]([Object(u["a"])({})],e),e}(u["c"]),H=G,J=H,W=s("99d9"),Y=s("12b2"),K=s("a523"),Q=s("169a"),X=s("0e8f"),Z=s("4bd4"),tt=s("a722"),et=s("2677"),st=Object(m["a"])(J,q,z,!1,null,null,null),rt=st.exports;g()(st,{VBtn:L["a"],VCard:_["a"],VCardText:W["a"],VCardTitle:Y["a"],VContainer:K["a"],VDialog:Q["a"],VFlex:X["a"],VForm:Z["a"],VLayout:tt["a"],VTextField:et["a"]});var nt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.store=B,e.drawer=!1,e}return l["c"](e,t),e=l["b"]([Object(u["a"])({components:{UserForList:T,UserForToolbar:M,RegisterUser:rt}})],e),e}(u["c"]),ot=nt,it=ot,at=(s("037a"),s("7496")),lt=s("549c"),ut=s("ce7e"),ct=s("f774"),pt=s("9910"),dt=s("71d9"),ht=s("706c"),vt=Object(m["a"])(it,i,a,!1,null,"7780b6a5",null),ft=vt.exports;g()(vt,{VApp:at["a"],VBtn:L["a"],VContainer:K["a"],VContent:lt["a"],VDivider:ut["a"],VIcon:P["a"],VList:j["a"],VListTile:w["a"],VListTileAction:O["a"],VListTileContent:x["a"],VListTileTitle:x["c"],VNavigationDrawer:ct["a"],VSpacer:pt["a"],VToolbar:dt["a"],VToolbarItems:F["a"],VToolbarSideIcon:ht["a"],VToolbarTitle:F["b"]});var bt=s("8c4f"),mt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"home"}},[s("v-list",{attrs:{"two-line":""}},[t._l(t.posts,function(t,e){return[s("TopPostTitle",{key:e,attrs:{post:t}})]})],2)],1)},yt=[],gt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-list-tile",{attrs:{to:{name:"userPost",params:{userName:t.post.userName,postId:t.post.postRef.id}}}},[s("v-list-tile-content",[s("v-list-tile-title",[t._v(t._s(t.post.subject))]),s("v-list-tile-sub-title",[t._v("\n\t\t\t"+t._s(t.date)+"\n\t\t\t -\n\t\t\t"),s("router-link",{attrs:{to:{name:"user",params:{userName:t.post.userName}}}},[t._v("\n\t\t\t\t"+t._s(t.post.userDisplayName)+"\n\t\t\t")])],1)],1)],1)},_t=[],Pt=s("d4cd"),jt=s.n(Pt),wt=jt()({html:!0,linkify:!0});function Ot(t){return wt.render(t)}function Vt(t){var e=t.toDate();return e.getFullYear()+"年"+(e.getMonth()+1)+"月"+e.getDate()+"日 "+e.getHours()+"時"+e.getMinutes()+"分"}var xt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l["c"](e,t),Object.defineProperty(e.prototype,"date",{get:function(){return Vt(this.post.created)},enumerable:!0,configurable:!0}),l["b"]([Object(u["b"])()],e.prototype,"post",void 0),e=l["b"]([Object(u["a"])({})],e),e}(u["c"]),Nt=xt,Tt=Nt,kt=Object(m["a"])(Tt,gt,_t,!1,null,null,null),Ct=kt.exports;g()(kt,{VListTile:w["a"],VListTileContent:x["a"],VListTileSubTitle:x["b"],VListTileTitle:x["c"]});var It=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.postRef=null,e.posts=[],e}return l["c"](e,t),e.prototype.created=function(){return l["a"](this,void 0,void 0,function(){var t,e,s=this;return l["d"](this,function(r){switch(r.label){case 0:console.log("home created"),this.postRef=h.a.firestore().collection("allPosts"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.postRef.orderBy("created","desc").limit(100).get()];case 2:return t=r.sent(),this.posts=[],t.forEach(function(t){var e=t.data();s.posts.push({subject:e.subject,body:e.body,created:e.created,updated:e.updated,postRef:e.postRef,userId:e.userId,userName:e.userName,userDisplayName:e.userDisplayName})}),[3,4];case 3:return e=r.sent(),console.error("get data error",e),[3,4];case 4:return[2]}})})},e=l["b"]([Object(u["a"])({components:{TopPostTitle:Ct}})],e),e}(u["c"]),$t=It,Ut=$t,Lt=Object(m["a"])(Ut,mt,yt,!1,null,null,null),Ft=Lt.exports;g()(Lt,{VList:j["a"]});var Et=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-form",{ref:"postForm",attrs:{id:"postForm","lazy-validation":""},on:{submit:function(e){return e.preventDefault(),t.post(e)}}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.msg,expression:"msg"}]},[t._v(t._s(t.msg))]),s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs12:"",md12:""}},[s("v-text-field",{attrs:{placeholder:"タイトル","aria-label":"ブログの記事タイトル",required:"",label:"タイトル",rules:t.titleRule},model:{value:t.subject,callback:function(e){t.subject=e},expression:"subject"}})],1),s("v-flex",{attrs:{xs12:"",sm12:"",md6:""}},[s("v-textarea",{attrs:{placeholder:"本文","aria-label":"ブログの本文",required:"","auto-grow":"",label:"本文",rules:t.bodyRule,rows:"16"},model:{value:t.body,callback:function(e){t.body=e},expression:"body"}})],1),s("v-flex",{attrs:{xs12:"",sm12:"",md6:""}},[s("MarkdownView",{attrs:{body:t.body}})],1)],1),s("v-btn",{attrs:{color:"success"},on:{click:t.post}},[t._v("投稿")])],1)},Mt=[],Rt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{domProps:{innerHTML:t._s(t.preview)}})},Dt=[],St=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l["c"](e,t),Object.defineProperty(e.prototype,"preview",{get:function(){return Ot(this.body)},enumerable:!0,configurable:!0}),l["b"]([Object(u["b"])()],e.prototype,"body",void 0),e=l["b"]([Object(u["a"])({})],e),e}(u["c"]),At=St,Bt=At,qt=Object(m["a"])(Bt,Rt,Dt,!1,null,null,null),zt=qt.exports,Gt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.subject="",e.body="",e.msg="",e}return l["c"](e,t),Object.defineProperty(e.prototype,"titleRule",{get:function(){return[function(t){return 0!==t.length||"タイトルを入力してください"}]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bodyRule",{get:function(){return[function(t){return 0!==t.length||"本文を入力してください"}]},enumerable:!0,configurable:!0}),e.prototype.post=function(){return l["a"](this,void 0,void 0,function(){var t,e;return l["d"](this,function(s){switch(s.label){case 0:if(console.log("posted"),console.log("validate?",this.$refs.postForm.validate()),!this.$refs.postForm.validate())return[2];if(null==this.owner||!this.owner.registered)return this.msg="ログインしてください。",[2];t={subject:this.subject,body:this.body,created:h.a.firestore.FieldValue.serverTimestamp(),updated:h.a.firestore.FieldValue.serverTimestamp()},console.log(t),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,h.a.firestore().collection("users").doc(this.owner.name).collection("posts").add(t)];case 2:return s.sent(),this.$_postForm_clear(),this.msg="投稿しました。",[3,4];case 3:return e=s.sent(),console.error("add error",e),this.msg="投稿失敗",[3,4];case 4:return[2]}})})},e.prototype.$_postForm_clear=function(){this.subject="",this.body="",this.$refs.postForm.resetValidation()},l["b"]([Object(u["b"])()],e.prototype,"owner",void 0),e=l["b"]([Object(u["a"])({components:{MarkdownView:zt}})],e),e}(u["c"]),Ht=Gt,Jt=Ht,Wt=s("a844"),Yt=Object(m["a"])(Jt,Et,Mt,!1,null,null,null),Kt=Yt.exports;g()(Yt,{VBtn:L["a"],VFlex:X["a"],VForm:Z["a"],VLayout:tt["a"],VTextField:et["a"],VTextarea:Wt["a"]});var Qt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"user"}},[t.user?s("h1",[t._v(t._s(t.user.displayName)+"の投稿")]):t._e(),[s("div",{staticClass:"prev_pager"},[t.hasPrev?[s("v-btn",{attrs:{color:"info"},on:{click:t.prev}},[t._v("新しい記事")])]:t._e()],2),t._l(t.posts,function(e,r){return s("PostView",{key:r,staticClass:"mb-4",attrs:{post:e,user:t.user}})}),s("div",{staticClass:"next_pager"},[t.hasNext?[s("v-btn",{attrs:{color:"info"},on:{click:t.next}},[t._v("前の記事")])]:t._e()],2)]],2)},Xt=[],Zt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-card",[s("v-card-title",[s("h1",[s("router-link",{attrs:{to:{name:"userPost",params:{userName:t.user.name,postId:t.post.id}}}},[t._v("\n\t\t\t\t"+t._s(t.post.subject)+"\n\t\t\t")])],1)]),s("v-divider"),s("v-card-text",[s("MarkdownView",{attrs:{body:t.post.body}})],1),s("v-divider"),s("v-card-text",[s("router-link",{attrs:{to:{name:"user",params:{userName:t.user.name}}}},[t._v("\n\t\t\t"+t._s(t.user.displayName)+"\n\t\t")]),s("span",[t._v(" - "+t._s(t.date))])],1)],1)},te=[],ee=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l["c"](e,t),Object.defineProperty(e.prototype,"date",{get:function(){return Vt(this.post.created)},enumerable:!0,configurable:!0}),l["b"]([Object(u["b"])()],e.prototype,"user",void 0),l["b"]([Object(u["b"])()],e.prototype,"post",void 0),e=l["b"]([Object(u["a"])({components:{MarkdownView:zt}})],e),e}(u["c"]),se=ee,re=se,ne=Object(m["a"])(re,Zt,te,!1,null,null,null),oe=ne.exports;g()(ne,{VCard:_["a"],VCardText:W["a"],VCardTitle:Y["a"],VDivider:ut["a"]});var ie=h.a.firestore,ae=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.posts=[],e.lastPost=null,e.firstPost=null,e.hasPrev=!1,e.hasNext=!1,e.user=null,e.sinceId=null,e}return l["c"](e,t),Object.defineProperty(e.prototype,"prevLink",{get:function(){return null==this.firstPost?"?":"?since="+this.firstPost.id+"&order=asc"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextLink",{get:function(){return null==this.lastPost?"?":"?since="+this.lastPost.id},enumerable:!0,configurable:!0}),e.prototype.next=function(){return l["a"](this,void 0,void 0,function(){var t,e;return l["d"](this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.$_UserPosts_getPosts(this.lastPost)];case 1:return t=s.sent(),this.posts=this.posts.concat(t),this.$_UserPosts_refreshLastFirst(t),[3,3];case 2:return e=s.sent(),[2,Promise.reject(e)];case 3:return[2]}})})},e.prototype.prev=function(){return l["a"](this,void 0,void 0,function(){var t,e,s=this;return l["d"](this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.$_UserPosts_getPosts(this.firstPost,"asc")];case 1:return t=r.sent(),t.forEach(function(t){s.posts.unshift(t)}),this.$_UserPosts_refreshLastFirst(t,"asc"),[3,3];case 2:return e=r.sent(),[2,Promise.reject(e)];case 3:return[2]}})})},e.prototype.created=function(){return l["a"](this,void 0,void 0,function(){var t,e,s,r;return l["d"](this,function(n){switch(n.label){case 0:console.log("user created",this.userName,this.since,this.order),t=ie().collection("users").doc(this.userName),n.label=1;case 1:return n.trys.push([1,4,,5]),this.sinceId=this.since,[4,t.get()];case 2:return e=n.sent(),s=this,[4,this.$_UserPosts_getPostsByProps()];case 3:return s.posts=n.sent(),"asc"===this.order&&this.posts.reverse(),this.user=R(this.userName,e.data()),this.$_UserPosts_refreshLastFirst(this.posts,this.order),[3,5];case 4:return r=n.sent(),console.error("get data error",r),[3,5];case 5:return[2]}})})},e.prototype.$_UserPosts_getPosts=function(t,e){return void 0===t&&(t=null),void 0===e&&(e="desc"),l["a"](this,void 0,void 0,function(){var s,r,n,o,i;return l["d"](this,function(a){switch(a.label){case 0:a.trys.push([0,5,,6]),s=ie().collection("users").doc(this.userName).collection("posts"),r=s.limit(this.pagingCount).orderBy("created",e),null!=t&&(r=r.startAfter(t.created)),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,r.get()];case 2:return n=a.sent(),[2,this.$_UserPosts_createPosts(n,e)];case 3:return o=a.sent(),[2,Promise.reject(o)];case 4:return[3,6];case 5:return i=a.sent(),[2,Promise.reject(i)];case 6:return[2]}})})},e.prototype.$_UserPosts_createPosts=function(t,e){void 0===e&&(e="desc");var s=[];return t.forEach(function(t){s.push(S(t))}),s},e.prototype.$_UserPosts_getPostsByProps=function(){return l["a"](this,void 0,void 0,function(){var t;return l["d"](this,function(e){switch(e.label){case 0:return null==this.since?[3,3]:[4,this.$_UserPosts_getPost(this.since)];case 1:return t=e.sent(),[4,this.$_UserPosts_getPosts(t,this.order)];case 2:return[2,e.sent()];case 3:return[2,this.$_UserPosts_getPosts()]}})})},e.prototype.$_UserPosts_refreshLastFirst=function(t,e){void 0===e&&(e="desc"),this.posts.length>0?(this.posts.length>this.showCount&&("desc"===e?(this.posts=this.posts.slice(this.posts.length-this.showCount),this.sinceId=this.posts[0].id):(this.posts=this.posts.slice(0,this.showCount-this.posts.length),this.sinceId=this.posts[this.posts.length-1].id)),this.lastPost=this.posts[this.posts.length-1],this.firstPost=this.posts[0]):(this.lastPost=null,this.firstPost=null),"desc"===e?(this.hasNext=t.length>=this.pagingCount,this.hasPrev=null!=this.sinceId):(this.hasPrev=t.length>=this.pagingCount,this.hasNext=null!=this.sinceId)},e.prototype.$_UserPosts_getPost=function(t){return l["a"](this,void 0,Promise,function(){var e,s,r;return l["d"](this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),e=ie().collection("users").doc(this.userName).collection("posts").doc(t),[4,e.get()];case 1:return s=n.sent(),s.exists?[2,S(s)]:[2,null];case 2:return r=n.sent(),[2,Promise.reject(r)];case 3:return[2]}})})},l["b"]([Object(u["b"])()],e.prototype,"userName",void 0),l["b"]([Object(u["b"])({required:!1,default:null})],e.prototype,"since",void 0),l["b"]([Object(u["b"])({required:!0,default:"desc"})],e.prototype,"order",void 0),l["b"]([Object(u["b"])({type:Number,default:5})],e.prototype,"pagingCount",void 0),l["b"]([Object(u["b"])({type:Number,default:10})],e.prototype,"showCount",void 0),e=l["b"]([Object(u["a"])({components:{PostView:oe}})],e),e}(u["c"]),le=ae,ue=le,ce=Object(m["a"])(ue,Qt,Xt,!1,null,null,null),pe=ce.exports;g()(ce,{VBtn:L["a"]});var de=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"home"}},[t.post?s("PostView",{attrs:{user:t.user,post:t.post}}):t._e(),s("RelativePost",{attrs:{post:t.post,userName:t.userName}})],1)},he=[],ve=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.relativePosts.length>0?s("h3",[t._v("他の記事")]):t._e(),s("ul",t._l(t.relativePosts,function(e,r){return s("li",{key:r},[s("PostLink",{attrs:{userName:t.userName,post:e}})],1)}),0)])},fe=[],be=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",[s("router-link",{attrs:{to:{name:"userPost",params:{userName:t.userName,postId:t.post.id}}}},[t._v("\n\t\t"+t._s(t.post.subject)+"\n\t")]),t._v("\n\t ("+t._s(t.date)+")\n")],1)},me=[],ye=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l["c"](e,t),Object.defineProperty(e.prototype,"date",{get:function(){return Vt(this.post.created)},enumerable:!0,configurable:!0}),l["b"]([Object(u["b"])()],e.prototype,"userName",void 0),l["b"]([Object(u["b"])()],e.prototype,"post",void 0),e=l["b"]([Object(u["a"])({})],e),e}(u["c"]),ge=ye,_e=ge,Pe=Object(m["a"])(_e,be,me,!1,null,null,null),je=Pe.exports,we=h.a.firestore,Oe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.relativePosts=[],e}return l["c"](e,t),e.prototype.$_RelativePost_onPostChanged=function(){return l["a"](this,void 0,void 0,function(){var t,e,s,r,n=this;return l["d"](this,function(o){switch(o.label){case 0:this.relativePosts=[],t=we().collection("users").doc(this.userName).collection("posts"),o.label=1;case 1:return o.trys.push([1,3,,4]),e=we.Timestamp.fromMillis(this.post.created.toMillis()-2592e6),[4,t.where("created",">",e).limit(10).get()];case 2:s=o.sent(),s.forEach(function(t){t.id!==n.post.id&&n.relativePosts.push(S(t))});while(this.relativePosts.length>3)this.relativePosts.splice(Math.floor(Math.random()*this.relativePosts.length),1);return[3,4];case 3:return r=o.sent(),console.error("get relative post error",r),[3,4];case 4:return[2]}})})},l["b"]([Object(u["b"])()],e.prototype,"userName",void 0),l["b"]([Object(u["b"])()],e.prototype,"post",void 0),l["b"]([Object(u["d"])("post")],e.prototype,"$_RelativePost_onPostChanged",null),e=l["b"]([Object(u["a"])({components:{PostLink:je}})],e),e}(u["c"]),Ve=Oe,xe=Ve,Ne=Object(m["a"])(xe,ve,fe,!1,null,null,null),Te=Ne.exports,ke=h.a.firestore,Ce=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.post=null,e.relativePosts=[],e.user=null,e}return l["c"](e,t),e.prototype.created=function(){return l["a"](this,void 0,void 0,function(){var t,e;return l["d"](this,function(s){switch(s.label){case 0:return console.log("user post created",this.userName,this.postId),t=ke().collection("users").doc(this.userName),[4,t.get()];case 1:return e=s.sent(),this.user=R(this.userName,e.data()),[2,this.$_UserPost_onPostIdChanged()]}})})},e.prototype.$_UserPost_onPostIdChanged=function(){return l["a"](this,void 0,void 0,function(){var t,e,s,r,n,o,i=this;return l["d"](this,function(a){switch(a.label){case 0:t=ke().collection("users").doc(this.userName),this.relativePosts=[],a.label=1;case 1:return a.trys.push([1,4,,5]),e=t.collection("posts"),[4,e.doc(this.postId).get()];case 2:return s=a.sent(),this.post=S(s),r=ke.Timestamp.fromMillis(this.post.created.toMillis()-2592e6),[4,e.where("created",">",r).limit(10).get()];case 3:n=a.sent(),n.forEach(function(t){t.id!==i.postId&&i.relativePosts.push(S(t))});while(this.relativePosts.length>3)this.relativePosts.splice(Math.floor(Math.random()*this.relativePosts.length),1);return[3,5];case 4:return o=a.sent(),console.error("get data error",o),[3,5];case 5:return[2]}})})},l["b"]([Object(u["b"])()],e.prototype,"userName",void 0),l["b"]([Object(u["b"])()],e.prototype,"postId",void 0),l["b"]([Object(u["d"])("postId")],e.prototype,"$_UserPost_onPostIdChanged",null),e=l["b"]([Object(u["a"])({components:{PostView:oe,RelativePost:Te}})],e),e}(u["c"]),Ie=Ce,$e=Ie,Ue=Object(m["a"])($e,de,he,!1,null,null,null),Le=Ue.exports;function Fe(t,e){return void 0===e&&(e=null),null==t?e:"string"===typeof t?parseInt(t,10):parseInt(t[0],10)}function Ee(t){return"asc"===t?"asc":"desc"}r["default"].use(bt["a"]);var Me=new bt["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:Ft},{path:"/about",name:"about",component:function(){return s.e("about").then(s.bind(null,"f3be"))}},{path:"/_do_post",name:"post",component:Kt,props:function(t){return{owner:B.user}}},{path:"/:userName",name:"user",component:pe,props:function(t){return{userName:t.params.userName,since:t.query.since,order:Ee(t.query.order),page:Fe(t.query.page,0)}}},{path:"/:userName/:postId",name:"userPost",component:Le,props:!0}]});r["default"].config.productionTip=!1;var Re={apiKey:"AIzaSyBjpgvDitkbscY8sGri0mHxoiInhhFrLt8",authDomain:"shinonomekazan-blog.firebaseapp.com",databaseURL:"https://shinonomekazan-blog.firebaseio.com",projectId:"shinonomekazan-blog",storageBucket:"shinonomekazan-blog.appspot.com",messagingSenderId:"1017881661292"};h.a.initializeApp(Re),B.initialize(),new r["default"]({router:Me,render:function(t){return t(ft)}}).$mount("#app")}});
//# sourceMappingURL=app.3dcaa13e.js.map